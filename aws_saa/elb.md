# ELB (Elastic Load Balancing)

マネージド型のロードバランシングサービスで、EC2インスタンスの処理を分散する際に標準的に利用する

- インスタンス間の負荷を分散する
- 異常なインスタンスを認識して対応する
  - 例えば止まってるインスタンスがあればそこにトラフィックを回さない
- パブリック、プライベートどちらでも利用可能
- ELB自体も負荷に応じてキャパシティを自動増減するスケーリングを実施
  - スケーリングはAWSが管理するマネージド型サービス
- 従量課金で利用可能
- マネージドサービスなので管理が不要（スケーリングとか）
- Auto Scaling、Route53、Could Formationなどと連携

## ELBの主要機能

- ヘルスチェック
  - EC2インスタンスの正常、異常を確認し、利用するEC2の振り分けを行う
- 負荷分散
  - 配下のEC2の負荷に応じて、複数のAZに跨るEC2インスタンスの負荷分散を行う
- SSLサポート
  - ELBでSSL Terminationできる
- スティッキーセッション
  - セッション中に同じユーザーから来たリクエストを全て同じEC2インスタンスに送信する
- Connecting Draining
  - インスタンスが登録解除されるか異常が発生した場合、そのバックエンドインスタンスへの新規リクエスト送信を中止する
    - インスタンスへのリクエストなどの処理をいきなり止めず、処理が完了するまで待つ。異常時の処理の仕方をコントロールできる
- S3へのログ保管
  - ELBのアクセスログを指定したS3に自動保管

### ELBによるスケーラビリティ

負荷分散によるスケーラビリティとヘルスチェックによる高可用性を実現

- スケーラビリティの確保
  - 複数のEC2インスタンス/ECS Serviceへの負荷分散
    - ひとつのEC2にはトラフィック量30、もうひとつには70といった感じ
- 高可用性
  - 複数のAZにある複数のEC2インスタンス、ECS Serviceの中から正常なターゲットにのみ振り分け