# EFS (Elastic File System)

複数のEC2インスタンスからアクセス可能な共有ストレージ

- S3
  - オブジェクト型のストレージでリージョンに設置
  - HTTPによるAPI経由でアクセス
  - 大容量のデータを長期保存するためのもの
- EBS
  - ブロック型のストレージでAZに設置。より高速に処理することができる
  - EC2インスタンスのディスクボリュームとして利用するが、物理的ではなくネットワーク経由で利用
    - 基本サーバーの記録ディスクとして利用する
  - 複数のEC2インスタンスにアタッチできない
- EFS
  - NASに似たファイルストレージ
  - ファイルシステムとして利用し、複数のEC2インスタンスでの共有アクセスが可能

## 特徴

その特徴はシンプルでスケーラブルで柔軟に利用できるファイルストレージであること

- シンプル
  - フルマネージド型サービス
  - 既存のNFSv4（操作クライアント）などのツールや、標準プロトコル/APIでアクセス可能
    - Network File System。分散ファイルシステム
- スケーラブル
  - ペタバイトまでスケーラブルにデータを蓄積
  - スループット/IOPS性能は自動的にスケーリングし、低レイテンシーを維持
- 柔軟性
  - ファイルの減少に合わせて自動で拡張、縮小
  - 事前に容量を設定する必要なし
  - 使った分だけの従量課金

## 基本性能

何千もの同時アクセスが実現可能という性能が特徴的

- 基本性能
  - 基本性能は100MB（バースト込み）
  - ファイル名は255バイト
  - 1ファイルの最大容量48TB
  - インスタンスあたり128ユーザーまでの同時オープンが可能
- 制限
  - アカウントあたりのファイルシステム数: 1,000
  - AZごとのファイルシステムあたりのマウントターゲット: 1
  - ファイルシステムあたりのタグ: 50
  - マウントターゲットあたりのセキュリティグループ: 5
  - ファイルシステムあたりのVPC数: 1
  - 各VPCのマウントターゲットの数: 400

## EFSのデータ保存

EFSのデータファイルは複数AZに分散して保存されている（フルマネージドで勝手に行われる）

## EFSの設定

EFS構築では次の設定を実施していく

- ファイルシステムを作成
- 接続先のマウントターゲットの作成
- セキュリティグループの作成
- パフォーマンスモードの選択