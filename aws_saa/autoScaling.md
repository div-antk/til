# Auto-Scaling

- 信頼とパフォーマンスに影響するスケーラビリティの確保である
- またベストプラクティスにおける「使い捨てリソースの使用」にもこれが重要になってくる
  - サーバーなどのコンポーネントを一時的なリソースとして利用、設計する
  - リソースを自動で減らしたり増やしたり

## スケーラビリティの確保

- 需要増にトラフィック量が処理できなくなる前に、処理サーバーを拡張することで対処する必要がある
- ELBでトラフィック量をチェックをしてはいるが、トラフィック量があまりにも増えると分散しても処理できなくなる
  - その場合新しいサーバーを増やす必要があるが、オンプレだとこれが諸々の手続きで1ヶ月くらいかかる。それをクラウド上で自動でやってくれるのがコレ

## スケーリングのタイプ

- 垂直スケーリングと水平スケーリングの2タイプがある
- Auto-Scalingは水平スケーリング

|      | 垂直スケーリング                 | 水平スケーリング                    |
| ---- | ------------------------ | --------------------------- |
| 拡張方法 | スケールアップ: メモリやCPUの追加、増強（サーバー内の機能を高める）   | スケールアウト: 処理する機器、サーバー台数を増加する（機器自体を増やす） |
| 低減方法 | スケールダウン: メモリやCPUの削減、低性能化 | スケールイン: 処理する機器、サーバー台数を低減する  |

## Auto-Scalingの要素

主に3つの要素で構成される

1. Auto-Scalingグループ
2. Auto-Scaling configuration: 起動設定
3. スケーリングプラン

### Auto-Scalingグループ

スケーリングするインスタンスの最大数など、基本情報を設定する

- 起動インスタンスの最小数と最大数を設定する
- 現時点で必要である最適なインスタンス数（Desired Capacity）の数量になるようにインスタンスを起動、終了を調整
- 起動台数をAZ間でバランシングする
- AZ障害時は、障害のない別のAZにその分のインスタンスを起動する

### Auto-Scaling configuration: 起動設定

スケールアウトの際に起動するインスタンス内容を設定する

- 主要な設定項目
  - AMI
  - インスタンスタイプ
  - セキュリティグループ
  - キーペア
  - IAMロール

### スケーリングプラン

どのようにスケールするかの方法を定義する

- Auto-Scaling Groupサイズの維持
  - 現在のAuto-Scaling Groupのインスタンス最小台数を維持する設定をする
- 主導スケーリング
  - 設定外で予期せぬスケーリングが必要になった場合に手動でスケーリングを実施
- スケジュールベース
  - 予測された需要増加時期にあわせたスケーリングスケジュールを設定
- 動的スケーリング
  - 予測不能なケースにスケーリングポリシーにスケール方法を設定して、動的にスケールアウトを実施
