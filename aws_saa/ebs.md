# EBS (Elastic Block Store)

- ブロック形式でデータ保存をするストレージサービス
- EC2を使うときに標準で使うことになる
- OSやアプリケーション、データの置き場所など様々な用途で使われる
- 1GB〜16TB。サイズと利用期間で課金
- AWS側で複数のハードウェアにデフォルトでレプリケート（複製を作っておく）されている。AWSが冗長化してくれている
- 通信制御対象外なのでポートを閉じてもEC2と接続できる
- EC2が削除されても残る設定もできる
- 他のAZのインスタンスにはアタッチできない（同じAZ内であれば付け替えもできる）
- 1つのEBSを複数のインスタンスで共有することはできない

## Snapshot

- ある瞬間のEBSの状態をS3にバックアップすること
- 圧縮後の容量に対して課金が行われる
- リージョン間をまたいで利用可能
- インスタンスを停止してから作成するのが望ましい（静止点）
- もしくは一定の時間で自動化
- ストレージの復元や複製に便利

## SnapshotとAMI (Amazon Machine Image)

- AMIはOS設定のイメージ、Snapshotはストレージのバックアップ
- AMIはインスタンスのOSは設定などをイメージとして保持して新規インスタンス設定に転用するもの（テンプレートみたいなやつ）

## EBSのボリュームタイプ

- 性能やコストが異なる5種類のボリュームタイプから選択できる

### SSD

- 汎用SSD
  - 1GB ~ 16TB
  - 仮想デスクトップ
  - 開発環境
  - 小、中規模
- プロビジョンドIOPS
  - 4GB ~ 16TB
  - 大規模DB

### HDD

- スループット最適化HDD
  - ビッグデータ処理
  - DWH（データウェアハウス）
  - 500GB ~ 16TB
- コールドHDD
  - ログデータなどのアクセス頻度が低いデータ
  - バックアップなど

### マグネティック

- 旧世代のボリューム
- 基本使わない
- 1GB ~ 1TB

## インスタンスストア

- EBSとは違って物理的にEC2に繋がれているストレージ
- ホストコンピュータに内蔵されたディスク
- EC2の一時的なデータが保持され、EC2の停止、終了とともにクリア
- 無料

## SnapshotとAMIの活用

1. AMIを作成してインスタンスに反映
2. 反映状況を確認
3. Snapshotを作成してEBSを複製
4. 複製結果を確認

### AMIから作成

- 停止した状態もしくは誰も操作してない時間帯にやる
- 『イメージの作成』
- 『AMI』を選択すると作成中であることがわかる
- AMIから『起動』
- webサーバーをもうインストールしてあるインスタンスをコピーするなどすれば効率がいい

### Snapshotから作成

- 『ボリューム』を選択
- 『アタッチ済み情報』からどのインスタンスと関連付けられてるか見る
- 『アクション』から『Snapshotの作成』
- 『スナップショット』から『ボリュームの作成』
- 『ボリュームのアタッチ』
- 『アタッチ済み情報』からコピーしてきたディレクトリ `/dev/xvda` をコピペして作成
- SSHでログインして確認した
