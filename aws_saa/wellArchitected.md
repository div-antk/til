# Well-Aechitected Framework（AWSアーキテクチャ設計の基礎）

- AWSの提唱する設計原則
- アソシエイト試験はWell-Aechitected Frameworkで提唱されている5つの設計原則に沿った試験範囲になっている

1. 回復性（信頼性）
2. パフォーマンス効率
3. セキュア
4. コスト最適化
5. オペレーショナルエクセレンス（運用上の優秀性）


## AZの選択

- 1つのリージョンにつき2つのAZを利用してアーキテクチャを設計することが基本（3つ以上はコスト効率が低下する）
  - ひとつのAZにEC2を作ったら、レプリケーションやロードバランサーを使った負荷分散するEC2を別のAZに置く
- マルチAZにサーバーやDBの冗長構成を確立させることで高い可用性を実現する
  - また、リージョンにおいたS3にレプリケーションでバックアップを取るなどする

## VPC

- 2つ以上のVPCでアーキテクチャを設計するのが基本となる
  - 1つのVPCだと……
    - 可用性が低下するため、アイデンティティ管理や、ハイパフォーマンス・コンピューティング（高性能計算）などに用途は限られる
    - 一人などの小規模な利用の場合は2つ以上VPCを利用するのが面倒なケースもある
- システム単位や組織単位で分ける
  - 『開発環境』と『本番環境』など
- ネットワークの分割方法はマルチVPC方式とマルチアカウント方式を選択する
  - 組織とかシステム単位によって分割方式を変えていく
  
### マルチVPC方式

- 複数のAZに跨いで、複数のシステムにVPCで分割していく
  - VPC[Aシステム] VPC[Bシステム] VPC[共通サービス] VPC[Cサービス]

#### マルチアカウント方式

- それぞれアカウント別にVPCを設定していく
  - VPC[A部署アカウント] VPC[B部署アカウント] VPC[共通サービスアカウント] VPC[C部署アカウント]

### サブネットの分割

- サブネットはCIDR範囲で分割したネットワークセグメント
- パブリックサブネットとプライベートサブネットで分かれている
- WEBアクセスが必要か否かでパブリックとプライベートに分割
- サブネットのサイズは `/24` 以上の大きいサブネットを推奨
- それぞれのAZの中にパブリックとプライベートを設置するのが一般的
- プライベートサブネットに多くのIPアドレスを割り当てる

#### パブリックサブネット

- インターネットと接続が必要なリソースを揃える
- インターネットとのアクセス制御に利用する
- ウェブアプリケーションのインターネットアクセス制御

#### プライベートサブネット

- インターネットから隔離することでセキュリティを高める
- データベース処理
- バッチ処理インスタンス
- バックエンドのインスタンス

### VPC間接続の設計

- VPC peeringにより2つのVPC間でのトラフィックルーティングが可能
- 接続が必要なVPCはそれぞれペアリングが必要となる
